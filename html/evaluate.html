<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<script src = "https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
<!-- script src="fileUpload.js" type="text/javascript" ></script> -->
<script src="evaluate.js" type="text/javascript" ></script>
<script src="modelresults.js" type="text/javascript" ></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<style>

.crosshair {cursor: crosshair;}
.asset-upload {
	border: 1pt solid red;
	height: 30pt;
	width: 100pt;
	text-align: center;
	border-radius: 6px;
	background-color: #eaeaea;
	margin-top: 5pt;
	padding: 5pt 5pt;
}

.inputfile {
	color:green;
	border:1pt solid red;
	width: 0.1px;
	height: 0.1px;
	opacity: 0;
	overflow: hidden;
	position: absolute;
	z-index: -1;
}
.inputfile + label {
	padding:10pt 5pt;
	color: red;
    border-radius: 4px;
   	box-shadow: 2px 2px 4px 4px rgba(127, 127, 127, 0.25);
}

.inputfile:focus + label,
.inputfile + label:hover {
    box-shadow: 2px 2px 4px 4px rgba(127, 127, 127, 0.45);
}
body {
	font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
}
table {
  border-collapse: collapse;
}
table, td, th {
  padding: 3pt 3pt 3pt 5pt;
}
table {
  border-top: 1px solid black;
}
table.nobd {
	border: 0pt solid white;
}
table.frame {
	border: 1pt solid gray;
}
table.list tr.list:nth-child(even) {
	background-color: #f5f5f5;
}
table.duo td.duo:nth-child(even), th.duo:nth-child(even) {
	border-left: 1pt solid gray;
}
table.list tr.list:hover {
	background-color: #e2e2e2;
}

img.sm {
	max-width: 100px;
	vertical-align: middle;
	border-radius: 4px;
   	box-shadow: 1px 1px 3px 3px rgba(127, 127, 127, 0.15);
}

.buttonlike {
	color: black;
	border: 1pt solid gray;
	padding:0pt 2pt 0pt 2pt;
}
</style>

<title>Evaluation: SkinCare Image Classifier</title>
</head>

<body ng-app = "myApp" ng-controller = "myCtrl"  ng-style="bodyStyle">


 <div style="margin: 10pt;">

	<div style="float:left;">
	<h1>Evaluation: SkinCare Image Classifier</h1>

		<p>Model: {{modelInfo.binary_classification_model}}
	</div>	

	
	<div style="float:left; margin-left:20pt;">
		<button ng-show="!testWithSamples"  style="color:green"
				ng-click="evaluateResults(true)"
					title="show sample">show sample</button>
		<button ng-show="testWithSamples" style="color:red; font-size:14pt;"
				title="Reset before using own images"
				ng-click="testWithSamples = false;evaluateResults()">RESET</button>
		<button ng-click="showhelp = true" style="margin-left:20pt; " ng-show="!showhelp">Help</button>
		<button ng-click="showhelp = false" style="margin-left:20pt; " ng-show="showhelp">Hide</button>
	</div>
	<div style=" float:left; margin-left:20pt; color:blue; width:400pt;" ng-show="showhelp">
		<span style="font-weight:bold">Evaluation</span><br>
			To evaluate the model choose benign images (left) and malign images (right) from your disk
			and click the button <span class="buttonlike" style="color:green">classify all loaded images ...</span>.
			
			All images will be classified, the resulting probabilities for classes
			'benign' and 'malign' will be shown together with the name and a thumbnail of the image.<br>
			After all images are classified the results are evaluated and different measures for quality are displayed.
			<p>
		<span style="font-weight:bold">Classification</span><br>
			To start the classifier for a single image load a file (in any of the two columns) and click the corresponding
			button <span class="buttonlike">classify</span>.
			You can trigger the evaluation manually after benign and malign images are classified by
			clicking <span class="buttonlike">evaluate classifications</span>.
			<p>A sample evaluation will be displayed when <span class="buttonlike">show sample</span> is clicked.
		<p>
			Alternatively use this <a href="/skin/classify.html" style="color:darkblue;">page to classify</a> single images
			and inspect various features.<p>
			By clicking on <span class="buttonlike" style="color:green">show sample</span>
			 (top of page) you can see the full functionality applied to an example image.
			<p>For further information please visit the <a href="http://iml.dfki.de/" style="color:blue;">IML homepage</a>.<p>
		<span style="color:black;">DFKI - German Research Center for Artificial Intelligence.</span>
	</div> 

	<div style="clear:left; float: left; margin-right: 10pt; margin-bottom: 20pt;">
			<table class="duo">
				<tr style="border-bottom:1pt solid black;">
					<th class="duo" >Benign Images
					<th class="duo" >Malign Images
				<tr class="list" >
					<td  class="duo" ng-repeat="type in ['benign', 'malign']" style="vertical-align: top; ">
						<div >
							<table class="nobd list">
								<tr>
									<th style="min-width: 100px">Image
									<th style="min-width: 120px">Name
									<th>Binary<br> Classification

								<tr class="list"  ng-repeat="uploadedFile in getImageList(type)">
									<td><img ng-src="{{uploadedFile.url}}" alt="image" class="sm"
										style="height: 80px; xmax-width: 90px;">
									<td>{{uploadedFile.name}}<p>
									<button ng-click="classifySingle(uploadedFile)" title="classify this {{type}} image"
										ng-disabled="classifierRunning || uploadedFile.predict" >classify</button>
									<td style="width:150px;">
											<table class="frame" style="width:140px;" ng-show="uploadedFile.predict"
												   title="marked if 'wrong' value is above {{markAsBadThreshold}}">
											<tr><td >Prediction
												<td><img width="18pt" ng-show="uploadedFile.class.gifcompute"
													 ng-src="{{uploadedFile.class.gifcompute}}">
											<tr><td><b>benign</b>:<td>
												<span ng-show="!uploadedFile.predict[0]"  style="width:35px;">&nbsp;</span>
												<span ng-show="type=='benign' || (type=='malign' && uploadedFile.predict[0] <= markAsBadThreshold)">
													{{uploadedFile.predict[0] | number: 2}}</span>
												<span ng-show="type=='malign' && uploadedFile.predict[0] > markAsBadThreshold" style="color:red"	>
													{{uploadedFile.predict[0] | number: 2}}</span>
											<tr><td><b>malign</b>:<td>
												<span ng-show="!uploadedFile.predict[1]" style="width:35px;">&nbsp;</span>
												<span ng-show="type=='benign' && uploadedFile.predict[1] > markAsBadThreshold" style="color:red">
													{{uploadedFile.predict[1] | number: 2}}</span>
												<span ng-show="type=='malign' || (type=='benign' && uploadedFile.predict[1] <= markAsBadThreshold)">
													{{uploadedFile.predict[1] | number: 2}}</span>
											</table>

							</table>
						</div>
				<tr  class="list" style="xborder-top:1pt solid black; border-bottom:1pt solid black;">
					<td  class="duo" style="padding:20pt 0pt 20pt 5pt;"
						 title="Drag&Drop image(s) to this field (does not work with all systems/browsers) or click to load image(s) from file system">
						<input type="file" class="inputfile" id="imginputB" accept="image/*" ng-file-model="myFilesBenign" multiple />
						<label for="imginputB"
							   upload ng-file-model="myFilesBenign" multiple="true">
								Choose or drop an image file(s)</label>
					<td  class="duo" style="padding:20pt 0pt 20pt 5pt;"
						 title="Drag&Drop image(s) to this field (does not work with all systems/browsers) or click to load image(s) from file system">
						<input type="file" class="inputfile" id="imginputM" accept="image/*" ng-file-model="myFilesMalign" multiple />
						<label for="imginputM"
							   upload ng-file-model="myFilesMalign" multiple="true">
								Choose or drop an image file</label>
				<tr  >
					<td class="duo" style="text-align:center; padding-top:5pt;">
						<button ng-click="classifyAll('benign')"
							title="classify all remaining benign images above"
							ng-disabled="classifierRunning || ! myFilesBenign">classify all benign images above</button>
					<td class="duo" style="text-align:center; padding-top:5pt;">
						<button ng-click="classifyAll('malign')"
							title="classify all remaiging malign images above"
							ng-disabled="classifierRunning || ! myFilesMalign">classify all malign images above</button>
				<tr ><td colspan="2" style="text-align:center;">
				<button ng-click="classify_evaluate()"
					title="start classification + evaluation"
					style="color: green; margin-top:10pt; font-size:14pt;"
					ng-disabled="!(!classifierRunning && myFilesBenign && myFilesMalign)">classify all loaded images and evaluate results</button>
				<p>
				<button ng-if=false ng-click="evaluateResults()"
					title="evaluate results of image classifications"
					ng-disabled="classificationResults.benign.length==0 ||classificationResults.malign.length==0">evaluate
					classifications</button>
			</td></tr>

			</table>

		</div>
		<div style="float: left; xborder: 1pt solid blue; width: 600px; padding-top: 5pt;">
			<div ng-if=false style="text-align: center">
				<button ng-click="classify_evaluate()"
					title="start classification + evaluation"
					style="color: green; xfont-weight: bold"
					ng-disabled="!(!classifierRunning && myFilesBenign && myFilesMalign)">classify all loaded images and evaluate results</button>
				<p>
				<button ng-click="evaluateResults()"
					title="evaluate results of image classifications"
					ng-disabled="classificationResults.benign.length==0 ||classificationResults.malign.length==0">evaluate
					classifications</button>

			</div>
			<br>
			<div id="chart"></div>
			<div>
				<div id="roc" style="float: left"></div>
				<div id="precrec" style="float: right"></div>
			</div>

		</div>

 </div>
 <div ng-if=false style="clear:all;position:absolute; bottom:0pt;">
{{getImageList()}}</div>
</body>
</html>